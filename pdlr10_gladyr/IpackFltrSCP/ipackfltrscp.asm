; Listing generated by Microsoft (R) Optimizing Compiler Version 15.00.30729.207 

	TITLE	c:\radasm\wdk\projects\driver_projects\pdlr10_gladyr\ipackfltrscp\ipackfltrscp.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	_serviceName
PUBLIC	_symbolicLinkName
PUBLIC	_imageName
_DATA	SEGMENT
_serviceName DB	'ipackfltr', 00H
	ORG $+2
_symbolicLinkName DB '\\.\ipackfltr', 00H
	ORG $+2
_imageName DB	'ipackfltr.sys', 00H
_DATA	ENDS
PUBLIC	??_C@_03PMGGPEJJ@?$CFd?6?$AA@			; `string'
PUBLIC	??_C@_04DOLEOMDD@GRE?6?$AA@			; `string'
PUBLIC	??_C@_04PJCLJNBJ@RDP?6?$AA@			; `string'
PUBLIC	??_C@_04ELALEBAJ@UDP?6?$AA@			; `string'
PUBLIC	??_C@_04OLLMFAAA@TCP?6?$AA@			; `string'
PUBLIC	??_C@_05MJKAJALF@IPv4?6?$AA@			; `string'
PUBLIC	??_C@_05HDJEMHHL@IGMP?6?$AA@			; `string'
PUBLIC	??_C@_05IGBEGBLL@ICMP?6?$AA@			; `string'
PUBLIC	??_C@_0BO@DCEJHPHA@Src?5?3?5?$CFs?7Dst?5?3?5?$CFs?7protocol?5?3?5?$AA@ ; `string'
PUBLIC	??_C@_0CE@EODGEPCN@?6ReadFile?5failed?4?5ErrorCode?$DN0x?$CF0@ ; `string'
PUBLIC	??_C@_0CM@DIMBJHGI@IOCTL_SET_FILTER?5failed?4?5ErrorCo@ ; `string'
PUBLIC	_ThreadRoutine@4
EXTRN	__imp__inet_ntoa@4:PROC
EXTRN	__imp__ReadFile@20:PROC
EXTRN	__imp__WaitForSingleObject@8:PROC
EXTRN	__imp__ExitThread@4:PROC
EXTRN	__imp__printf:PROC
EXTRN	__imp__GetLastError@0:PROC
EXTRN	__imp__DeviceIoControl@32:PROC
EXTRN	_memset:PROC
;	COMDAT ??_C@_03PMGGPEJJ@?$CFd?6?$AA@
; File c:\radasm\wdk\projects\driver_projects\pdlr10_gladyr\ipackfltrscp\ipackfltrscp.c
CONST	SEGMENT
??_C@_03PMGGPEJJ@?$CFd?6?$AA@ DB '%d', 0aH, 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_04DOLEOMDD@GRE?6?$AA@
CONST	SEGMENT
??_C@_04DOLEOMDD@GRE?6?$AA@ DB 'GRE', 0aH, 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_04PJCLJNBJ@RDP?6?$AA@
CONST	SEGMENT
??_C@_04PJCLJNBJ@RDP?6?$AA@ DB 'RDP', 0aH, 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_04ELALEBAJ@UDP?6?$AA@
CONST	SEGMENT
??_C@_04ELALEBAJ@UDP?6?$AA@ DB 'UDP', 0aH, 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_04OLLMFAAA@TCP?6?$AA@
CONST	SEGMENT
??_C@_04OLLMFAAA@TCP?6?$AA@ DB 'TCP', 0aH, 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_05MJKAJALF@IPv4?6?$AA@
CONST	SEGMENT
??_C@_05MJKAJALF@IPv4?6?$AA@ DB 'IPv4', 0aH, 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_05HDJEMHHL@IGMP?6?$AA@
CONST	SEGMENT
??_C@_05HDJEMHHL@IGMP?6?$AA@ DB 'IGMP', 0aH, 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_05IGBEGBLL@ICMP?6?$AA@
CONST	SEGMENT
??_C@_05IGBEGBLL@ICMP?6?$AA@ DB 'ICMP', 0aH, 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0BO@DCEJHPHA@Src?5?3?5?$CFs?7Dst?5?3?5?$CFs?7protocol?5?3?5?$AA@
CONST	SEGMENT
??_C@_0BO@DCEJHPHA@Src?5?3?5?$CFs?7Dst?5?3?5?$CFs?7protocol?5?3?5?$AA@ DB 'S'
	DB	'rc : %s', 09H, 'Dst : %s', 09H, 'protocol : ', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0CE@EODGEPCN@?6ReadFile?5failed?4?5ErrorCode?$DN0x?$CF0@
CONST	SEGMENT
??_C@_0CE@EODGEPCN@?6ReadFile?5failed?4?5ErrorCode?$DN0x?$CF0@ DB 0aH, 'R'
	DB	'eadFile failed. ErrorCode=0x%08X.', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0CM@DIMBJHGI@IOCTL_SET_FILTER?5failed?4?5ErrorCo@
CONST	SEGMENT
??_C@_0CM@DIMBJHGI@IOCTL_SET_FILTER?5failed?4?5ErrorCo@ DB 'IOCTL_SET_FIL'
	DB	'TER failed. ErrorCode=0x%08X.', 0aH, 00H	; `string'
; Function compile flags: /Odtp
CONST	ENDS
;	COMDAT _ThreadRoutine@4
_TEXT	SEGMENT
tv148 = -2576						; size = 4
_result$ = -2572					; size = 4
_packetsNumber$ = -2568					; size = 4
_counterBytes$ = -2564					; size = 4
_outputBuffer$ = -2560					; size = 2560
_ctx$ = 8						; size = 4
_ThreadRoutine@4 PROC					; COMDAT

; 10   : {

	npad	2
	push	ebp
	mov	ebp, esp
	sub	esp, 2576				; 00000a10H

; 11   : 	IPHeader		outputBuffer[128]	= {0};	// від драйвера

	mov	BYTE PTR _outputBuffer$[ebp], 0
	push	2559					; 000009ffH
	push	0
	lea	eax, DWORD PTR _outputBuffer$[ebp+1]
	push	eax
	call	_memset
	add	esp, 12					; 0000000cH

; 12   : 	BOOL		result			= FALSE;

	mov	DWORD PTR _result$[ebp], 0

; 13   : 	ULONG		packetsNumber	= 0;

	mov	DWORD PTR _packetsNumber$[ebp], 0

; 14   : 	DWORD		counterBytes		= 0;

	mov	DWORD PTR _counterBytes$[ebp], 0

; 15   : 	
; 16   : 	result = DeviceIoControl(	((ThreadContext*)ctx)->device, 
; 17   : 							IOCTL_SET_FILTER, 
; 18   : 							(void*)NULL, 0 , (void*)NULL, 0,
; 19   : 							&counterBytes, NULL);

	push	0
	lea	ecx, DWORD PTR _counterBytes$[ebp]
	push	ecx
	push	0
	push	0
	push	0
	push	0
	push	2236416					; 00222000H
	mov	edx, DWORD PTR _ctx$[ebp]
	mov	eax, DWORD PTR [edx]
	push	eax
	call	DWORD PTR __imp__DeviceIoControl@32
	mov	DWORD PTR _result$[ebp], eax

; 20   : 	if(!result)

	cmp	DWORD PTR _result$[ebp], 0
	jne	SHORT $LN16@ThreadRout

; 21   : 	{
; 22   : 		_tprintf(_TEXT("IOCTL_SET_FILTER failed. ErrorCode=0x%08X.\n"), GetLastError());

	call	DWORD PTR __imp__GetLastError@0
	push	eax
	push	OFFSET ??_C@_0CM@DIMBJHGI@IOCTL_SET_FILTER?5failed?4?5ErrorCo@
	call	DWORD PTR __imp__printf
	add	esp, 8

; 23   : 		ExitThread((DWORD)result);

	mov	ecx, DWORD PTR _result$[ebp]
	push	ecx
	call	DWORD PTR __imp__ExitThread@4
$LN16@ThreadRout:

; 24   : 	}
; 25   : 	
; 26   : 	while( WAIT_OBJECT_0 != WaitForSingleObject(
; 27   : 								((ThreadContext*)ctx)->stopEvent, 1000) ) 

	push	1000					; 000003e8H
	mov	edx, DWORD PTR _ctx$[ebp]
	mov	eax, DWORD PTR [edx+4]
	push	eax
	call	DWORD PTR __imp__WaitForSingleObject@8
	test	eax, eax
	je	$LN15@ThreadRout

; 28   : 	{
; 29   : 		if(!ReadFile(	((ThreadContext*)ctx)->device, 
; 30   : 					&outputBuffer, sizeof(outputBuffer), 
; 31   : 					&counterBytes, NULL)	)

	push	0
	lea	ecx, DWORD PTR _counterBytes$[ebp]
	push	ecx
	push	2560					; 00000a00H
	lea	edx, DWORD PTR _outputBuffer$[ebp]
	push	edx
	mov	eax, DWORD PTR _ctx$[ebp]
	mov	ecx, DWORD PTR [eax]
	push	ecx
	call	DWORD PTR __imp__ReadFile@20
	test	eax, eax
	jne	SHORT $LN14@ThreadRout

; 32   : 		{
; 33   : 			_tprintf(_TEXT("\nReadFile failed. ErrorCode=0x%08X."), GetLastError());

	call	DWORD PTR __imp__GetLastError@0
	push	eax
	push	OFFSET ??_C@_0CE@EODGEPCN@?6ReadFile?5failed?4?5ErrorCode?$DN0x?$CF0@
	call	DWORD PTR __imp__printf
	add	esp, 8

; 34   : 			continue;	

	jmp	SHORT $LN16@ThreadRout
$LN14@ThreadRout:

; 35   : 		}
; 36   : 		
; 37   : 		for(	packetsNumber = 0; 
; 38   : 			packetsNumber < counterBytes / sizeof(IPHeader);
; 39   : 			packetsNumber++)

	mov	DWORD PTR _packetsNumber$[ebp], 0
	jmp	SHORT $LN13@ThreadRout
$LN12@ThreadRout:
	mov	edx, DWORD PTR _packetsNumber$[ebp]
	add	edx, 1
	mov	DWORD PTR _packetsNumber$[ebp], edx
$LN13@ThreadRout:
	mov	eax, DWORD PTR _counterBytes$[ebp]
	xor	edx, edx
	mov	ecx, 20					; 00000014H
	div	ecx
	cmp	DWORD PTR _packetsNumber$[ebp], eax
	jae	$LN11@ThreadRout

; 40   : 		{
; 41   : 			_tprintf(_TEXT("Src : %s\tDst : %s\tprotocol : "),
; 42   : 				inet_ntoa(outputBuffer[packetsNumber].iph_src),
; 43   : 				inet_ntoa(outputBuffer[packetsNumber].iph_dest));				

	mov	edx, DWORD PTR _packetsNumber$[ebp]
	imul	edx, 20					; 00000014H
	mov	eax, DWORD PTR _outputBuffer$[ebp+edx+16]
	push	eax
	call	DWORD PTR __imp__inet_ntoa@4
	push	eax
	mov	ecx, DWORD PTR _packetsNumber$[ebp]
	imul	ecx, 20					; 00000014H
	mov	edx, DWORD PTR _outputBuffer$[ebp+ecx+12]
	push	edx
	call	DWORD PTR __imp__inet_ntoa@4
	push	eax
	push	OFFSET ??_C@_0BO@DCEJHPHA@Src?5?3?5?$CFs?7Dst?5?3?5?$CFs?7protocol?5?3?5?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 12					; 0000000cH

; 44   : 			
; 45   : 			switch(outputBuffer[packetsNumber].iph_protocol)

	mov	eax, DWORD PTR _packetsNumber$[ebp]
	imul	eax, 20					; 00000014H
	movzx	ecx, BYTE PTR _outputBuffer$[ebp+eax+9]
	mov	DWORD PTR tv148[ebp], ecx
	mov	edx, DWORD PTR tv148[ebp]
	sub	edx, 1
	mov	DWORD PTR tv148[ebp], edx
	cmp	DWORD PTR tv148[ebp], 46		; 0000002eH
	ja	$LN1@ThreadRout
	mov	eax, DWORD PTR tv148[ebp]
	movzx	ecx, BYTE PTR $LN21@ThreadRout[eax]
	jmp	DWORD PTR $LN22@ThreadRout[ecx*4]
$LN8@ThreadRout:

; 46   : 			{
; 47   : 				case	 1:
; 48   : 					_tprintf(_TEXT("ICMP\n"));

	push	OFFSET ??_C@_05IGBEGBLL@ICMP?6?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 4

; 49   : 					break;

	jmp	SHORT $LN9@ThreadRout
$LN7@ThreadRout:

; 50   : 				case 2:
; 51   : 					_tprintf(_TEXT("IGMP\n"));

	push	OFFSET ??_C@_05HDJEMHHL@IGMP?6?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 4

; 52   : 					break;

	jmp	SHORT $LN9@ThreadRout
$LN6@ThreadRout:

; 53   : 				case 4:
; 54   : 					_tprintf(_TEXT("IPv4\n"));

	push	OFFSET ??_C@_05MJKAJALF@IPv4?6?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 4

; 55   : 					break;

	jmp	SHORT $LN9@ThreadRout
$LN5@ThreadRout:

; 56   : 				case 6:
; 57   : 					_tprintf(_TEXT("TCP\n"));

	push	OFFSET ??_C@_04OLLMFAAA@TCP?6?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 4

; 58   : 					break;

	jmp	SHORT $LN9@ThreadRout
$LN4@ThreadRout:

; 59   : 				case 17:
; 60   : 					_tprintf(_TEXT("UDP\n"));

	push	OFFSET ??_C@_04ELALEBAJ@UDP?6?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 4

; 61   : 					break;

	jmp	SHORT $LN9@ThreadRout
$LN3@ThreadRout:

; 62   : 				case 27:
; 63   : 					_tprintf(_TEXT("RDP\n"));

	push	OFFSET ??_C@_04PJCLJNBJ@RDP?6?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 4

; 64   : 					break;

	jmp	SHORT $LN9@ThreadRout
$LN2@ThreadRout:

; 65   : 				case 47:
; 66   : 					_tprintf(_TEXT("GRE\n"));

	push	OFFSET ??_C@_04DOLEOMDD@GRE?6?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 4

; 67   : 					break;

	jmp	SHORT $LN9@ThreadRout
$LN1@ThreadRout:

; 68   : 				default:
; 69   : 					_tprintf(_TEXT("%d\n", outputBuffer[packetsNumber].iph_protocol));

	push	OFFSET ??_C@_03PMGGPEJJ@?$CFd?6?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 4
$LN9@ThreadRout:

; 70   : 			}
; 71   : 		}

	jmp	$LN12@ThreadRout
$LN11@ThreadRout:

; 72   : 
; 73   : 	}

	jmp	$LN16@ThreadRout
$LN15@ThreadRout:

; 74   : 	DeviceIoControl(	((ThreadContext*)ctx)->device, 
; 75   : 					IOCTL_RESET_FILTER, 
; 76   : 					(void*)NULL, 0 , (void*)NULL, 0,
; 77   : 					&counterBytes, NULL);

	push	0
	lea	edx, DWORD PTR _counterBytes$[ebp]
	push	edx
	push	0
	push	0
	push	0
	push	0
	push	2236420					; 00222004H
	mov	eax, DWORD PTR _ctx$[ebp]
	mov	ecx, DWORD PTR [eax]
	push	ecx
	call	DWORD PTR __imp__DeviceIoControl@32

; 78   : 	
; 79   : 	ExitThread((DWORD)result);	

	mov	edx, DWORD PTR _result$[ebp]
	push	edx
	call	DWORD PTR __imp__ExitThread@4
$LN19@ThreadRout:

; 80   : }

	mov	esp, ebp
	pop	ebp
	ret	4
	npad	1
$LN22@ThreadRout:
	DD	$LN8@ThreadRout
	DD	$LN7@ThreadRout
	DD	$LN6@ThreadRout
	DD	$LN5@ThreadRout
	DD	$LN4@ThreadRout
	DD	$LN3@ThreadRout
	DD	$LN2@ThreadRout
	DD	$LN1@ThreadRout
$LN21@ThreadRout:
	DB	0
	DB	1
	DB	7
	DB	2
	DB	7
	DB	3
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	4
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	5
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	7
	DB	6
_ThreadRoutine@4 ENDP
_TEXT	ENDS
PUBLIC	??_C@_0BI@LGCNFJIL@?6Press?5?8Enter?8?5to?5exit?6?$AA@ ; `string'
PUBLIC	??_C@_0CN@JEBFDAOH@?6Can?8t?5delete?5service?5?8?$CFs?8?4?5Erro@ ; `string'
PUBLIC	??_C@_0BG@HLANJPHO@?6Service?5?8?$CFs?8?5deleted?$AA@ ; `string'
PUBLIC	??_C@_0CL@DNLIHKOL@?6Can?8t?5stop?5service?5?8?$CFs?8?4?5ErrorC@ ; `string'
PUBLIC	??_C@_0BG@GNCMMNDN@?6Service?5?8?$CFs?8?5stopped?$AA@ ; `string'
PUBLIC	??_C@_0DB@HNPALFON@?6Can?8t?5open?5symbolik?5link?5?8?$CFs?8?4?5@ ; `string'
PUBLIC	??_C@_0CN@NIILNDPD@?6Can?8t?5start?5service?5?8?$CFs?8?4?5Error@ ; `string'
PUBLIC	??_C@_0BO@FMFCEEJB@?6Service?5?8?$CFs?8?5already?5running?$AA@ ; `string'
PUBLIC	??_C@_0BH@EKJNPEMA@?6Service?5?8?$CFs?8?5started?6?$AA@ ; `string'
PUBLIC	??_C@_0CN@LJAJMOLA@?6Can?8t?5create?5service?5?8?$CFs?8?4?5Erro@ ; `string'
PUBLIC	??_C@_0BG@BDOMDCP@?6Service?5?8?$CFs?8?5created?$AA@ ; `string'
PUBLIC	??_C@_0DO@DMADPKCI@?6Can?8t?5get?5full?5path?5for?5service@ ; `string'
PUBLIC	??_C@_0DJ@MAJKNFIF@?6Can?8t?5open?5service?5?8?$CFs?8?4?5ErrorC@ ; `string'
PUBLIC	??_C@_0BF@HJJJKPCP@?6Service?5?8?$CFs?8?5opened?$AA@ ; `string'
PUBLIC	??_C@_0DF@NHKGILHH@?6Can?8t?5open?5Service?5Control?5Mana@ ; `string'
PUBLIC	??_C@_0BO@OGPOAGEO@?O?p?n?c?p?$OA?l?$OA?5?s?o?p?$OA?b?k?$LD?m?m?$PP?5?d?p?$OA?i?b?e?p?n?l?$AA@ ; `string'
PUBLIC	__$ArrayPad$
PUBLIC	_main
EXTRN	__imp__CloseServiceHandle@4:PROC
EXTRN	__imp__DeleteService@4:PROC
EXTRN	__imp__ControlService@12:PROC
EXTRN	__imp__CloseHandle@4:PROC
EXTRN	__imp__SetEvent@4:PROC
EXTRN	__imp__getchar:PROC
EXTRN	__imp__CreateThread@24:PROC
EXTRN	__imp__CreateEventA@16:PROC
EXTRN	__imp__CreateFileA@28:PROC
EXTRN	__imp__StartServiceA@12:PROC
EXTRN	__imp__CreateServiceA@52:PROC
EXTRN	__imp__GetFullPathNameA@16:PROC
EXTRN	__imp__OpenServiceA@12:PROC
EXTRN	__imp__OpenSCManagerA@12:PROC
EXTRN	__imp__SetConsoleTitleA@4:PROC
EXTRN	___security_cookie:DWORD
EXTRN	@__security_check_cookie@4:PROC
;	COMDAT ??_C@_0BI@LGCNFJIL@?6Press?5?8Enter?8?5to?5exit?6?$AA@
CONST	SEGMENT
??_C@_0BI@LGCNFJIL@?6Press?5?8Enter?8?5to?5exit?6?$AA@ DB 0aH, 'Press ''E'
	DB	'nter'' to exit', 0aH, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0CN@JEBFDAOH@?6Can?8t?5delete?5service?5?8?$CFs?8?4?5Erro@
CONST	SEGMENT
??_C@_0CN@JEBFDAOH@?6Can?8t?5delete?5service?5?8?$CFs?8?4?5Erro@ DB 0aH, 'C'
	DB	'an''t delete service ''%s''. ErrorCode=0x%0X.', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BG@HLANJPHO@?6Service?5?8?$CFs?8?5deleted?$AA@
CONST	SEGMENT
??_C@_0BG@HLANJPHO@?6Service?5?8?$CFs?8?5deleted?$AA@ DB 0aH, 'Service '''
	DB	'%s'' deleted', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0CL@DNLIHKOL@?6Can?8t?5stop?5service?5?8?$CFs?8?4?5ErrorC@
CONST	SEGMENT
??_C@_0CL@DNLIHKOL@?6Can?8t?5stop?5service?5?8?$CFs?8?4?5ErrorC@ DB 0aH, 'C'
	DB	'an''t stop service ''%s''. ErrorCode=0x%0X.', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BG@GNCMMNDN@?6Service?5?8?$CFs?8?5stopped?$AA@
CONST	SEGMENT
??_C@_0BG@GNCMMNDN@?6Service?5?8?$CFs?8?5stopped?$AA@ DB 0aH, 'Service '''
	DB	'%s'' stopped', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0DB@HNPALFON@?6Can?8t?5open?5symbolik?5link?5?8?$CFs?8?4?5@
CONST	SEGMENT
??_C@_0DB@HNPALFON@?6Can?8t?5open?5symbolik?5link?5?8?$CFs?8?4?5@ DB 0aH, 'C'
	DB	'an''t open symbolik link ''%s''. ErrorCode=0x%0X.', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0CN@NIILNDPD@?6Can?8t?5start?5service?5?8?$CFs?8?4?5Error@
CONST	SEGMENT
??_C@_0CN@NIILNDPD@?6Can?8t?5start?5service?5?8?$CFs?8?4?5Error@ DB 0aH, 'C'
	DB	'an''t start service ''%s''. ErrorCode=0x%08X.', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BO@FMFCEEJB@?6Service?5?8?$CFs?8?5already?5running?$AA@
CONST	SEGMENT
??_C@_0BO@FMFCEEJB@?6Service?5?8?$CFs?8?5already?5running?$AA@ DB 0aH, 'S'
	DB	'ervice ''%s'' already running', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0BH@EKJNPEMA@?6Service?5?8?$CFs?8?5started?6?$AA@
CONST	SEGMENT
??_C@_0BH@EKJNPEMA@?6Service?5?8?$CFs?8?5started?6?$AA@ DB 0aH, 'Service '
	DB	'''%s'' started', 0aH, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0CN@LJAJMOLA@?6Can?8t?5create?5service?5?8?$CFs?8?4?5Erro@
CONST	SEGMENT
??_C@_0CN@LJAJMOLA@?6Can?8t?5create?5service?5?8?$CFs?8?4?5Erro@ DB 0aH, 'C'
	DB	'an''t create service ''%s''. ErrorCode=0x%0X.', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BG@BDOMDCP@?6Service?5?8?$CFs?8?5created?$AA@
CONST	SEGMENT
??_C@_0BG@BDOMDCP@?6Service?5?8?$CFs?8?5created?$AA@ DB 0aH, 'Service ''%'
	DB	's'' created', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0DO@DMADPKCI@?6Can?8t?5get?5full?5path?5for?5service@
CONST	SEGMENT
??_C@_0DO@DMADPKCI@?6Can?8t?5get?5full?5path?5for?5service@ DB 0aH, 'Can'''
	DB	't get full path for service image ''%s''. ErrorCode=0x%0X.', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0DJ@MAJKNFIF@?6Can?8t?5open?5service?5?8?$CFs?8?4?5ErrorC@
CONST	SEGMENT
??_C@_0DJ@MAJKNFIF@?6Can?8t?5open?5service?5?8?$CFs?8?4?5ErrorC@ DB 0aH, 'C'
	DB	'an''t open service ''%s''. ErrorCode=0x%0X.', 0aH, 'Try creat'
	DB	'e...', 00H					; `string'
CONST	ENDS
;	COMDAT ??_C@_0BF@HJJJKPCP@?6Service?5?8?$CFs?8?5opened?$AA@
CONST	SEGMENT
??_C@_0BF@HJJJKPCP@?6Service?5?8?$CFs?8?5opened?$AA@ DB 0aH, 'Service ''%'
	DB	's'' opened', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0DF@NHKGILHH@?6Can?8t?5open?5Service?5Control?5Mana@
CONST	SEGMENT
??_C@_0DF@NHKGILHH@?6Can?8t?5open?5Service?5Control?5Mana@ DB 0aH, 'Can'''
	DB	't open Service Control Manager. ErrorCode=0x%0X', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BO@OGPOAGEO@?O?p?n?c?p?$OA?l?$OA?5?s?o?p?$OA?b?k?$LD?m?m?$PP?5?d?p?$OA?i?b?e?p?n?l?$AA@
CONST	SEGMENT
??_C@_0BO@OGPOAGEO@?O?p?n?c?p?$OA?l?$OA?5?s?o?p?$OA?b?k?$LD?m?m?$PP?5?d?p?$OA?i?b?e?p?n?l?$AA@ DB 0cfH
	DB	0f0H, 0eeH, 0e3H, 0f0H, 0e0H, 0ecH, 0e0H, ' ', 0f3H, 0efH, 0f0H
	DB	0e0H, 0e2H, 0ebH, 0b3H, 0edH, 0edH, 0ffH, ' ', 0e4H, 0f0H, 0e0H
	DB	0e9H, 0e2H, 0e5H, 0f0H, 0eeH, 0ecH, 00H	; `string'
; Function compile flags: /Odtp
CONST	ENDS
;	COMDAT _main
_TEXT	SEGMENT
_statusBefore$ = -588					; size = 4
_lastError$ = -584					; size = 4
_serviceStatus$ = -580					; size = 28
_counterBytes$ = -552					; size = 4
_scm$ = -548						; size = 4
_service$ = -544					; size = 4
_device$ = -540						; size = 4
_threadCtx$ = -536					; size = 8
_fullImagePath$ = -528					; size = 520
__$ArrayPad$ = -8					; size = 4
_thread$ = -4						; size = 4
_main	PROC						; COMDAT

; 83   : {

	npad	2
	push	ebp
	mov	ebp, esp
	sub	esp, 588				; 0000024cH
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, ebp
	mov	DWORD PTR __$ArrayPad$[ebp], eax

; 84   : 	HANDLE				scm = NULL;

	mov	DWORD PTR _scm$[ebp], 0

; 85   : 	HANDLE				service = NULL;

	mov	DWORD PTR _service$[ebp], 0

; 86   : 	HANDLE				device = INVALID_HANDLE_VALUE;

	mov	DWORD PTR _device$[ebp], -1

; 87   : 	DWORD				counterBytes		= 0;	

	mov	DWORD PTR _counterBytes$[ebp], 0

; 88   : 	DWORD				lastError = ERROR_SUCCESS;

	mov	DWORD PTR _lastError$[ebp], 0

; 89   : 	DWORD				statusBefore = SERVICE_NOT_INSTALLED;

	mov	DWORD PTR _statusBefore$[ebp], 0

; 90   : 	TCHAR				fullImagePath[2*MAX_PATH] = {0};

	mov	BYTE PTR _fullImagePath$[ebp], 0
	push	519					; 00000207H
	push	0
	lea	eax, DWORD PTR _fullImagePath$[ebp+1]
	push	eax
	call	_memset
	add	esp, 12					; 0000000cH

; 91   : 	SERVICE_STATUS		serviceStatus = {0};

	mov	DWORD PTR _serviceStatus$[ebp], 0
	xor	ecx, ecx
	mov	DWORD PTR _serviceStatus$[ebp+4], ecx
	mov	DWORD PTR _serviceStatus$[ebp+8], ecx
	mov	DWORD PTR _serviceStatus$[ebp+12], ecx
	mov	DWORD PTR _serviceStatus$[ebp+16], ecx
	mov	DWORD PTR _serviceStatus$[ebp+20], ecx
	mov	DWORD PTR _serviceStatus$[ebp+24], ecx

; 92   : 	ThreadContext		threadCtx	= {0};

	mov	DWORD PTR _threadCtx$[ebp], 0
	xor	edx, edx
	mov	DWORD PTR _threadCtx$[ebp+4], edx

; 93   : 	HANDLE				thread		= 0;

	mov	DWORD PTR _thread$[ebp], 0

; 94   : 	 	
; 95   : 	SetConsoleTitle(_TEXT("Програма управління драйвером"));

	push	OFFSET ??_C@_0BO@OGPOAGEO@?O?p?n?c?p?$OA?l?$OA?5?s?o?p?$OA?b?k?$LD?m?m?$PP?5?d?p?$OA?i?b?e?p?n?l?$AA@
	call	DWORD PTR __imp__SetConsoleTitleA@4

; 96   : 	scm = OpenSCManager(NULL, NULL, SC_MANAGER_ALL_ACCESS);

	push	983103					; 000f003fH
	push	0
	push	0
	call	DWORD PTR __imp__OpenSCManagerA@12
	mov	DWORD PTR _scm$[ebp], eax

; 97   : 	if(!scm)

	cmp	DWORD PTR _scm$[ebp], 0
	jne	SHORT $LN23@main

; 98   : 	{
; 99   : 		lastError = GetLastError();

	call	DWORD PTR __imp__GetLastError@0
	mov	DWORD PTR _lastError$[ebp], eax

; 100  : 		_tprintf(_TEXT("\nCan't open Service Control Manager. ErrorCode=0x%0X"), lastError);

	mov	eax, DWORD PTR _lastError$[ebp]
	push	eax
	push	OFFSET ??_C@_0DF@NHKGILHH@?6Can?8t?5open?5Service?5Control?5Mana@
	call	DWORD PTR __imp__printf
	add	esp, 8

; 101  : 		return lastError;

	mov	eax, DWORD PTR _lastError$[ebp]
	jmp	$LN24@main
$LN23@main:

; 102  : 	}
; 103  : 
; 104  : 	service = OpenService(scm, serviceName,	SERVICE_START | SERVICE_STOP);

	push	48					; 00000030H
	push	OFFSET _serviceName
	mov	ecx, DWORD PTR _scm$[ebp]
	push	ecx
	call	DWORD PTR __imp__OpenServiceA@12
	mov	DWORD PTR _service$[ebp], eax

; 105  : 	if(service)

	cmp	DWORD PTR _service$[ebp], 0
	je	SHORT $LN22@main

; 106  : 	{
; 107  : 		statusBefore |= SERVICE_OPENED;

	mov	edx, DWORD PTR _statusBefore$[ebp]
	or	edx, 8
	mov	DWORD PTR _statusBefore$[ebp], edx

; 108  : 		_tprintf(_TEXT("\nService '%s' opened"), serviceName);

	push	OFFSET _serviceName
	push	OFFSET ??_C@_0BF@HJJJKPCP@?6Service?5?8?$CFs?8?5opened?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 8

; 109  : 	}
; 110  : 	else

	jmp	$LN21@main
$LN22@main:

; 111  : 	{
; 112  : 		_tprintf(_TEXT("\nCan't open service '%s'. ErrorCode=0x%0X.\nTry create..."), 
; 113  : 					serviceName, GetLastError());

	call	DWORD PTR __imp__GetLastError@0
	push	eax
	push	OFFSET _serviceName
	push	OFFSET ??_C@_0DJ@MAJKNFIF@?6Can?8t?5open?5service?5?8?$CFs?8?4?5ErrorC@
	call	DWORD PTR __imp__printf
	add	esp, 12					; 0000000cH

; 114  : 		counterBytes = GetFullPathName(
; 115  : 								imageName,
; 116  : 								sizeof (fullImagePath)/sizeof(TCHAR), 
; 117  : 								fullImagePath, NULL);

	push	0
	lea	eax, DWORD PTR _fullImagePath$[ebp]
	push	eax
	push	520					; 00000208H
	push	OFFSET _imageName
	call	DWORD PTR __imp__GetFullPathNameA@16
	mov	DWORD PTR _counterBytes$[ebp], eax

; 118  : 		if(counterBytes == 0 || counterBytes > sizeof (fullImagePath)/sizeof(TCHAR))

	cmp	DWORD PTR _counterBytes$[ebp], 0
	je	SHORT $LN19@main
	cmp	DWORD PTR _counterBytes$[ebp], 520	; 00000208H
	jbe	SHORT $LN20@main
$LN19@main:

; 119  : 		{
; 120  : 			lastError = GetLastError();

	call	DWORD PTR __imp__GetLastError@0
	mov	DWORD PTR _lastError$[ebp], eax

; 121  : 			_tprintf(_TEXT("\nCan't get full path for service image '%s'. ErrorCode=0x%0X."), 
; 122  : 						imageName, lastError);

	mov	ecx, DWORD PTR _lastError$[ebp]
	push	ecx
	push	OFFSET _imageName
	push	OFFSET ??_C@_0DO@DMADPKCI@?6Can?8t?5get?5full?5path?5for?5service@
	call	DWORD PTR __imp__printf
	add	esp, 12					; 0000000cH

; 123  : 		}
; 124  : 		else

	jmp	$LN21@main
$LN20@main:

; 125  : 		{
; 126  : 			service = CreateService(
; 127  : 							scm,
; 128  : 							serviceName,
; 129  : 							serviceName,
; 130  : 							SERVICE_START | SERVICE_STOP | DELETE,
; 131  : 							SERVICE_KERNEL_DRIVER,
; 132  : 							SERVICE_DEMAND_START,
; 133  : 							SERVICE_ERROR_IGNORE,
; 134  : 							fullImagePath,
; 135  : 							NULL, NULL, NULL, NULL, NULL);

	push	0
	push	0
	push	0
	push	0
	push	0
	lea	edx, DWORD PTR _fullImagePath$[ebp]
	push	edx
	push	0
	push	3
	push	1
	push	65584					; 00010030H
	push	OFFSET _serviceName
	push	OFFSET _serviceName
	mov	eax, DWORD PTR _scm$[ebp]
	push	eax
	call	DWORD PTR __imp__CreateServiceA@52
	mov	DWORD PTR _service$[ebp], eax

; 136  : 			if(service)

	cmp	DWORD PTR _service$[ebp], 0
	je	SHORT $LN17@main

; 137  : 			{
; 138  : 				statusBefore |= SERVICE_INSTALLED;

	mov	ecx, DWORD PTR _statusBefore$[ebp]
	or	ecx, 1
	mov	DWORD PTR _statusBefore$[ebp], ecx

; 139  : 				_tprintf(_TEXT("\nService '%s' created"), serviceName);

	push	OFFSET _serviceName
	push	OFFSET ??_C@_0BG@BDOMDCP@?6Service?5?8?$CFs?8?5created?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 8

; 140  : 			}
; 141  : 			else

	jmp	SHORT $LN21@main
$LN17@main:

; 142  : 			{
; 143  : 				lastError = GetLastError();

	call	DWORD PTR __imp__GetLastError@0
	mov	DWORD PTR _lastError$[ebp], eax

; 144  : 				_tprintf(_TEXT("\nCan't create service '%s'. ErrorCode=0x%0X."),
; 145  : 						 serviceName, lastError);

	mov	edx, DWORD PTR _lastError$[ebp]
	push	edx
	push	OFFSET _serviceName
	push	OFFSET ??_C@_0CN@LJAJMOLA@?6Can?8t?5create?5service?5?8?$CFs?8?4?5Erro@
	call	DWORD PTR __imp__printf
	add	esp, 12					; 0000000cH
$LN21@main:

; 146  : 			}
; 147  : 		}
; 148  : 	}
; 149  : 
; 150  : 	if(service)

	cmp	DWORD PTR _service$[ebp], 0
	je	$LN15@main

; 151  : 	{
; 152  : 		if( StartService(service, 0, NULL) )

	push	0
	push	0
	mov	eax, DWORD PTR _service$[ebp]
	push	eax
	call	DWORD PTR __imp__StartServiceA@12
	test	eax, eax
	je	SHORT $LN14@main

; 153  : 		{
; 154  : 			statusBefore |= SERVICE_STARTED;

	mov	ecx, DWORD PTR _statusBefore$[ebp]
	or	ecx, 2
	mov	DWORD PTR _statusBefore$[ebp], ecx

; 155  : 			_tprintf(_TEXT("\nService '%s' started\n"), serviceName);

	push	OFFSET _serviceName
	push	OFFSET ??_C@_0BH@EKJNPEMA@?6Service?5?8?$CFs?8?5started?6?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 8

; 156  : 		}
; 157  : 		else

	jmp	SHORT $LN13@main
$LN14@main:

; 158  : 		{
; 159  : 			lastError = GetLastError();

	call	DWORD PTR __imp__GetLastError@0
	mov	DWORD PTR _lastError$[ebp], eax

; 160  : 			if(ERROR_SERVICE_ALREADY_RUNNING == lastError)

	cmp	DWORD PTR _lastError$[ebp], 1056	; 00000420H
	jne	SHORT $LN12@main

; 161  : 			{
; 162  : 				_tprintf(_TEXT("\nService '%s' already running"), serviceName);

	push	OFFSET _serviceName
	push	OFFSET ??_C@_0BO@FMFCEEJB@?6Service?5?8?$CFs?8?5already?5running?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 8

; 163  : 				statusBefore |= SERVICE_RUNNING;

	mov	edx, DWORD PTR _statusBefore$[ebp]
	or	edx, 4
	mov	DWORD PTR _statusBefore$[ebp], edx

; 164  : 			}
; 165  : 			else

	jmp	SHORT $LN13@main
$LN12@main:

; 166  : 			{
; 167  : 				_tprintf(_TEXT("\nCan't start service '%s'. ErrorCode=0x%08X."),
; 168  : 							serviceName, lastError);

	mov	eax, DWORD PTR _lastError$[ebp]
	push	eax
	push	OFFSET _serviceName
	push	OFFSET ??_C@_0CN@NIILNDPD@?6Can?8t?5start?5service?5?8?$CFs?8?4?5Error@
	call	DWORD PTR __imp__printf
	add	esp, 12					; 0000000cH
$LN13@main:

; 169  : 			}
; 170  : 		}
; 171  : 		
; 172  : 		if( (statusBefore & SERVICE_STARTED) || (statusBefore & SERVICE_RUNNING) )

	mov	ecx, DWORD PTR _statusBefore$[ebp]
	and	ecx, 2
	jne	SHORT $LN9@main
	mov	edx, DWORD PTR _statusBefore$[ebp]
	and	edx, 4
	je	$LN15@main
$LN9@main:

; 173  : 		{
; 174  : 			threadCtx.device = CreateFile(
; 175  : 								symbolicLinkName,
; 176  : 								GENERIC_READ | GENERIC_WRITE, 
; 177  : 								0, NULL, 	OPEN_EXISTING, 0, NULL);

	push	0
	push	0
	push	3
	push	0
	push	0
	push	-1073741824				; c0000000H
	push	OFFSET _symbolicLinkName
	call	DWORD PTR __imp__CreateFileA@28
	mov	DWORD PTR _threadCtx$[ebp], eax

; 178  : 			
; 179  : 			if(INVALID_HANDLE_VALUE == threadCtx.device)

	cmp	DWORD PTR _threadCtx$[ebp], -1
	jne	SHORT $LN8@main

; 180  : 			{
; 181  : 				lastError = GetLastError();

	call	DWORD PTR __imp__GetLastError@0
	mov	DWORD PTR _lastError$[ebp], eax

; 182  : 				_tprintf(_TEXT("\nCan't open symbolik link '%s'. ErrorCode=0x%0X."),
; 183  : 							symbolicLinkName, lastError);

	mov	eax, DWORD PTR _lastError$[ebp]
	push	eax
	push	OFFSET _symbolicLinkName
	push	OFFSET ??_C@_0DB@HNPALFON@?6Can?8t?5open?5symbolik?5link?5?8?$CFs?8?4?5@
	call	DWORD PTR __imp__printf
	add	esp, 12					; 0000000cH

; 184  : 			}
; 185  : 			else

	jmp	SHORT $LN15@main
$LN8@main:

; 186  : 			{
; 187  : 				threadCtx.stopEvent = CreateEvent(NULL, FALSE, FALSE, NULL);

	push	0
	push	0
	push	0
	push	0
	call	DWORD PTR __imp__CreateEventA@16
	mov	DWORD PTR _threadCtx$[ebp+4], eax

; 188  : 				thread = CreateThread(NULL,0,ThreadRoutine,&threadCtx,0,NULL);

	push	0
	push	0
	lea	ecx, DWORD PTR _threadCtx$[ebp]
	push	ecx
	push	OFFSET _ThreadRoutine@4
	push	0
	push	0
	call	DWORD PTR __imp__CreateThread@24
	mov	DWORD PTR _thread$[ebp], eax

; 189  : 				_gettchar();	_gettchar();

	call	DWORD PTR __imp__getchar
	call	DWORD PTR __imp__getchar

; 190  : 				SetEvent(threadCtx.stopEvent);

	mov	edx, DWORD PTR _threadCtx$[ebp+4]
	push	edx
	call	DWORD PTR __imp__SetEvent@4

; 191  : 				WaitForSingleObject(thread, INFINITE);

	push	-1
	mov	eax, DWORD PTR _thread$[ebp]
	push	eax
	call	DWORD PTR __imp__WaitForSingleObject@8

; 192  : 				CloseHandle(threadCtx.device);

	mov	ecx, DWORD PTR _threadCtx$[ebp]
	push	ecx
	call	DWORD PTR __imp__CloseHandle@4

; 193  : 				CloseHandle(threadCtx.stopEvent);

	mov	edx, DWORD PTR _threadCtx$[ebp+4]
	push	edx
	call	DWORD PTR __imp__CloseHandle@4
$LN15@main:

; 194  : 			}
; 195  : 		}
; 196  : 	}
; 197  : 
; 198  : 	if(statusBefore & SERVICE_STARTED)

	mov	eax, DWORD PTR _statusBefore$[ebp]
	and	eax, 2
	je	SHORT $LN6@main

; 199  : 	{
; 200  : 		if(ControlService(service, SERVICE_CONTROL_STOP, &serviceStatus))

	lea	ecx, DWORD PTR _serviceStatus$[ebp]
	push	ecx
	push	1
	mov	edx, DWORD PTR _service$[ebp]
	push	edx
	call	DWORD PTR __imp__ControlService@12
	test	eax, eax
	je	SHORT $LN5@main

; 201  : 		{
; 202  : 			_tprintf(_TEXT("\nService '%s' stopped"), serviceName);

	push	OFFSET _serviceName
	push	OFFSET ??_C@_0BG@GNCMMNDN@?6Service?5?8?$CFs?8?5stopped?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 8

; 203  : 		}
; 204  : 		else

	jmp	SHORT $LN6@main
$LN5@main:

; 205  : 		{
; 206  : 			lastError = GetLastError();

	call	DWORD PTR __imp__GetLastError@0
	mov	DWORD PTR _lastError$[ebp], eax

; 207  : 			_tprintf(_TEXT("\nCan't stop service '%s'. ErrorCode=0x%0X."),
; 208  : 						 serviceName, lastError);

	mov	eax, DWORD PTR _lastError$[ebp]
	push	eax
	push	OFFSET _serviceName
	push	OFFSET ??_C@_0CL@DNLIHKOL@?6Can?8t?5stop?5service?5?8?$CFs?8?4?5ErrorC@
	call	DWORD PTR __imp__printf
	add	esp, 12					; 0000000cH
$LN6@main:

; 209  : 		}
; 210  : 	}
; 211  : 	if( (statusBefore & SERVICE_INSTALLED) && (SERVICE_STOPPED == serviceStatus.dwCurrentState) )

	mov	ecx, DWORD PTR _statusBefore$[ebp]
	and	ecx, 1
	je	SHORT $LN3@main
	cmp	DWORD PTR _serviceStatus$[ebp+4], 1
	jne	SHORT $LN3@main

; 212  : 	{
; 213  : 		if( DeleteService(service) )

	mov	edx, DWORD PTR _service$[ebp]
	push	edx
	call	DWORD PTR __imp__DeleteService@4
	test	eax, eax
	je	SHORT $LN2@main

; 214  : 		{
; 215  : 			_tprintf(_TEXT("\nService '%s' deleted"), serviceName);

	push	OFFSET _serviceName
	push	OFFSET ??_C@_0BG@HLANJPHO@?6Service?5?8?$CFs?8?5deleted?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 8

; 216  : 		}
; 217  : 		else

	jmp	SHORT $LN3@main
$LN2@main:

; 218  : 		{
; 219  : 			lastError = GetLastError();

	call	DWORD PTR __imp__GetLastError@0
	mov	DWORD PTR _lastError$[ebp], eax

; 220  : 			_tprintf(_TEXT("\nCan't delete service '%s'. ErrorCode=0x%0X."),
; 221  : 						 serviceName, lastError);

	mov	eax, DWORD PTR _lastError$[ebp]
	push	eax
	push	OFFSET _serviceName
	push	OFFSET ??_C@_0CN@JEBFDAOH@?6Can?8t?5delete?5service?5?8?$CFs?8?4?5Erro@
	call	DWORD PTR __imp__printf
	add	esp, 12					; 0000000cH
$LN3@main:

; 222  : 		}
; 223  : 	}
; 224  : 
; 225  : 	CloseServiceHandle(service);

	mov	ecx, DWORD PTR _service$[ebp]
	push	ecx
	call	DWORD PTR __imp__CloseServiceHandle@4

; 226  : 	CloseServiceHandle(scm);

	mov	edx, DWORD PTR _scm$[ebp]
	push	edx
	call	DWORD PTR __imp__CloseServiceHandle@4

; 227  : 	_tprintf(_TEXT("\nPress 'Enter' to exit\n"));

	push	OFFSET ??_C@_0BI@LGCNFJIL@?6Press?5?8Enter?8?5to?5exit?6?$AA@
	call	DWORD PTR __imp__printf
	add	esp, 4

; 228  : 	_gettchar();

	call	DWORD PTR __imp__getchar

; 229  : 	return lastError;

	mov	eax, DWORD PTR _lastError$[ebp]
$LN24@main:

; 230  : }

	mov	ecx, DWORD PTR __$ArrayPad$[ebp]
	xor	ecx, ebp
	call	@__security_check_cookie@4
	mov	esp, ebp
	pop	ebp
	ret	0
_main	ENDP
_TEXT	ENDS
END
